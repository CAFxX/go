//go:build ignore

// To regenerate known_headers.go, run `go generate`.

package main

import (
	"bytes"
	"fmt"
	"go/format"
	"net/textproto"
	"os"
	"sort"
)

func main() {
	m := map[string]struct{}{}
	for _, h := range knownHeaders {
		h = textproto.CanonicalMIMEHeaderKey(h)
		m[h] = struct{}{}
	}
	knownHeaders := []string{}
	for h := range m {
		knownHeaders = append(knownHeaders, h)
	}
	sort.Strings(knownHeaders)

	buf := &bytes.Buffer{}
	fmt.Fprintf(buf, `// Code generated by gen_known_headers.go. DO NOT EDIT.
package textproto

// headerToString matches the canonical header name in the passed slice
// and returns the singleton string instance of %d known, common headers.
// If the header is not known, the passed slice is returned as a string.
//
// A header is eligible for inclusion in headerToString if, either:
//  1. It is a standard header, e.g. listed in a RFC or other standards.
//  2. It is a header that can be shown to be commonly used in the wild.
func headerToString(a []byte) (s string) {
	switch string(a) { // Compiler knows how to avoid allocating the string.
`,
		len(knownHeaders))
	for _, v := range knownHeaders {
		fmt.Fprintf(buf, "  case %[1]q: s = %[1]q\n", v)
	}
	fmt.Fprintln(buf, `}
	return
}`)

	code, err := format.Source(buf.Bytes())
	if err != nil {
		panic(err)
	}
	err = os.WriteFile("known_headers.go", code, 0666)
	if err != nil {
		panic(err)
	}
}

var knownHeaders = []string{
	// https://www.iana.org/assignments/http-fields/http-fields.xhtml
	"A-IM",
	"Accept",
	"Accept-Additions",
	"Accept-CH",
	"Accept-Charset",
	"Accept-Datetime",
	"Accept-Encoding",
	"Accept-Features",
	"Accept-Language",
	"Accept-Patch",
	"Accept-Post",
	"Accept-Ranges",
	"Access-Control",
	"Access-Control-Allow-Credentials",
	"Access-Control-Allow-Headers",
	"Access-Control-Allow-Methods",
	"Access-Control-Allow-Origin",
	"Access-Control-Expose-Headers",
	"Access-Control-Max-Age",
	"Access-Control-Request-Headers",
	"Access-Control-Request-Method",
	"Age",
	"Allow",
	"ALPN",
	"Alt-Svc",
	"Alt-Used",
	"Alternates",
	"AMP-Cache-Transform",
	"Apply-To-Redirect-Ref",
	"Authentication-Control",
	"Authentication-Info",
	"Authorization",
	"C-Ext",
	"C-Man",
	"C-Opt",
	"C-PEP",
	"C-PEP-Info",
	"Cache-Control",
	"Cache-Status",
	"Cal-Managed-ID",
	"CalDAV-Timezones",
	"Capsule-Protocol",
	"CDN-Cache-Control",
	"CDN-Loop",
	"Cert-Not-After",
	"Cert-Not-Before",
	"Clear-Site-Data",
	"Client-Cert",
	"Client-Cert-Chain",
	"Close",
	"Configuration-Context",
	"Connection",
	"Content-Base",
	"Content-Disposition",
	"Content-Encoding",
	"Content-ID",
	"Content-Language",
	"Content-Length",
	"Content-Location",
	"Content-MD5",
	"Content-Range",
	"Content-Script-Type",
	"Content-Security-Policy",
	"Content-Security-Policy-Report-Only",
	"Content-Style-Type",
	"Content-Type",
	"Content-Version",
	"Cookie",
	"Cookie2",
	"Cross-Origin-Embedder-Policy",
	"Cross-Origin-Embedder-Policy-Report-Only",
	"Cross-Origin-Opener-Policy",
	"Cross-Origin-Opener-Policy-Report-Only",
	"Cross-Origin-Resource-Policy",
	"DASL",
	"Date",
	"DAV",
	"Default-Style",
	"Delta-Base",
	"Depth",
	"Derived-From",
	"Destination",
	"Differential-ID",
	"Digest",
	"Early-Data",
	"EDIINT-Features",
	"ETag",
	"Expect",
	"Expect-CT",
	"Expires",
	"Ext",
	"Forwarded",
	"From",
	"GetProfile",
	"Hobareg",
	"Host",
	"HTTP2-Settings",
	"If",
	"If-Match",
	"If-Modified-Since",
	"If-None-Match",
	"If-Range",
	"If-Schedule-Tag-Match",
	"If-Unmodified-Since",
	"IM",
	"Include-Referred-Token-Binding-ID",
	"Isolation",
	"Keep-Alive",
	"Label",
	"Last-Event-ID",
	"Last-Modified",
	"Link",
	"Location",
	"Lock-Token",
	"Man",
	"Max-Forwards",
	"Memento-Datetime",
	"Meter",
	"Method-Check",
	"Method-Check-Expires",
	"MIME-Version",
	"Negotiate",
	"OData-EntityId",
	"OData-Isolation",
	"OData-MaxVersion",
	"OData-Version",
	"Opt",
	"Optional-WWW-Authenticate",
	"Ordering-Type",
	"Origin",
	"Origin-Agent-Cluster",
	"OSCORE",
	"OSLC-Core-Version",
	"Overwrite",
	"P3P",
	"PEP",
	"Pep-Info",
	"PICS-Label",
	"Ping-From",
	"Ping-To",
	"Position",
	"Pragma",
	"Prefer",
	"Preference-Applied",
	"Priority",
	"ProfileObject",
	"Protocol",
	"Protocol-Info",
	"Protocol-Query",
	"Protocol-Request",
	"Proxy-Authenticate",
	"Proxy-Authentication-Info",
	"Proxy-Authorization",
	"Proxy-Features",
	"Proxy-Instruction",
	"Proxy-Status",
	"Public",
	"Public-Key-Pins",
	"Public-Key-Pins-Report-Only",
	"Range",
	"Redirect-Ref",
	"Referer",
	"Referer-Root",
	"Refresh",
	"Repeatability-Client-ID",
	"Repeatability-First-Sent",
	"Repeatability-Request-ID",
	"Repeatability-Result",
	"Replay-Nonce",
	"Retry-After",
	"Safe",
	"Schedule-Reply",
	"Schedule-Tag",
	"Sec-GPC",
	"Sec-Purpose",
	"Sec-Token-Binding",
	"Sec-WebSocket-Accept",
	"Sec-WebSocket-Extensions",
	"Sec-WebSocket-Key",
	"Sec-WebSocket-Protocol",
	"Sec-WebSocket-Version",
	"Security-Scheme",
	"Server",
	"Server-Timing",
	"Set-Cookie",
	"Set-Cookie2",
	"SetProfile",
	"SLUG",
	"SoapAction",
	"Status-URI",
	"Strict-Transport-Security",
	"Sunset",
	"Surrogate-Capability",
	"Surrogate-Control",
	"TCN",
	"TE",
	"Timeout",
	"Timing-Allow-Origin",
	"Topic",
	"Traceparent",
	"Tracestate",
	"Trailer",
	"Transfer-Encoding",
	"TTL",
	"Upgrade",
	"Urgency",
	"URI",
	"User-Agent",
	"Variant-Vary",
	"Vary",
	"Via",
	"Want-Digest",
	"Warning",
	"WWW-Authenticate",
	"X-Content-Type-Options",
	"X-Frame-Options",

	// https://www.iana.org/assignments/message-headers/message-headers.xhtml
	"Accept-Language",
	"Also-Control",
	"Alternate-Recipient",
	"Approved",
	"ARC-Authentication-Results",
	"ARC-Message-Signature",
	"ARC-Seal",
	"Archive",
	"Archived-At",
	"Archived-At",
	"Article-Names",
	"Article-Updates",
	"Authentication-Results",
	"Auto-Submitted",
	"Autoforwarded",
	"Autosubmitted",
	"Base",
	"Bcc",
	"Body",
	"Cancel-Key",
	"Cancel-Lock",
	"Cc",
	"Comments",
	"Comments",
	"Content-Alternative",
	"Content-Base",
	"Content-Description",
	"Content-Disposition",
	"Content-Duration",
	"Content-features",
	"Content-ID",
	"Content-Identifier",
	"Content-Language",
	"Content-Location",
	"Content-MD5",
	"Content-Return",
	"Content-Transfer-Encoding",
	"Content-Translation-Type",
	"Content-Type",
	"Control",
	"Conversion",
	"Conversion-With-Loss",
	"DL-Expansion-History",
	"Date",
	"Date",
	"Date-Received",
	"Deferred-Delivery",
	"Delivery-Date",
	"Discarded-X400-IPMS-Extensions",
	"Discarded-X400-MTS-Extensions",
	"Disclose-Recipients",
	"Disposition-Notification-Options",
	"Disposition-Notification-To",
	"Distribution",
	"DKIM-Signature",
	"Downgraded-Bcc",
	"Downgraded-Cc",
	"Downgraded-Disposition-Notification-To",
	"Downgraded-Final-Recipient",
	"Downgraded-From",
	"Downgraded-In-Reply-To",
	"Downgraded-Mail-From",
	"Downgraded-Message-Id",
	"Downgraded-Original-Recipient",
	"Downgraded-Rcpt-To",
	"Downgraded-References",
	"Downgraded-Reply-To",
	"Downgraded-Resent-Bcc",
	"Downgraded-Resent-Cc",
	"Downgraded-Resent-From",
	"Downgraded-Resent-Reply-To",
	"Downgraded-Resent-Sender",
	"Downgraded-Resent-To",
	"Downgraded-Return-Path",
	"Downgraded-Sender",
	"Downgraded-To",
	"Encoding",
	"Encrypted",
	"Expires",
	"Expires",
	"Expiry-Date",
	"Followup-To",
	"From",
	"From",
	"Generate-Delivery-Report",
	"Importance",
	"In-Reply-To",
	"Incomplete-Copy",
	"Injection-Date",
	"Injection-Info",
	"Keywords",
	"Keywords",
	"Language",
	"Latest-Delivery-Time",
	"Lines",
	"List-Archive",
	"List-Help",
	"List-ID",
	"List-Owner",
	"List-Post",
	"List-Subscribe",
	"List-Unsubscribe",
	"List-Unsubscribe-Post",
	"Message-Context",
	"Message-ID",
	"Message-ID",
	"Message-Type",
	"MIME-Version",
	"MMHS-Exempted-Address",
	"MMHS-Extended-Authorisation-Info",
	"MMHS-Subject-Indicator-Codes",
	"MMHS-Handling-Instructions",
	"MMHS-Message-Instructions",
	"MMHS-Codress-Message-Indicator",
	"MMHS-Originator-Reference",
	"MMHS-Primary-Precedence",
	"MMHS-Copy-Precedence",
	"MMHS-Message-Type",
	"MMHS-Other-Recipients-Indicator-To",
	"MMHS-Other-Recipients-Indicator-CC",
	"MMHS-Acp127-Message-Identifier",
	"MMHS-Originator-PLAD",
	"MT-Priority",
	"Newsgroups",
	"NNTP-Posting-Date",
	"NNTP-Posting-Host",
	"Obsoletes",
	"Organization",
	"Organization",
	"Original-Encoded-Information-Types",
	"Original-From",
	"Original-Message-ID",
	"Original-Recipient",
	"Original-Sender",
	"Originator-Return-Address",
	"Original-Subject",
	"Path",
	"PICS-Label",
	"Posting-Version",
	"Prevent-NonDelivery-Report",
	"Priority",
	"Received",
	"Received-SPF",
	"References",
	"References",
	"Relay-Version",
	"Reply-By",
	"Reply-To",
	"Reply-To",
	"Require-Recipient-Valid-Since",
	"Resent-Bcc",
	"Resent-Cc",
	"Resent-Date",
	"Resent-From",
	"Resent-Message-ID",
	"Resent-Reply-To",
	"Resent-Sender",
	"Resent-To",
	"Return-Path",
	"See-Also",
	"Sender",
	"Sender",
	"Sensitivity",
	"Solicitation",
	"Subect",
	"Subject",
	"Summary",
	"Supersedes",
	"Supersedes",
	"TLS-Report-Domain",
	"TLS-Report-Submitter",
	"TLS-Required",
	"To",
	"User-Agent",
	"VBR-Info",
	"X400-Content-Identifier",
	"X400-Content-Return",
	"X400-Content-Type",
	"X400-MTS-Identifier",
	"X400-Originator",
	"X400-Received",
	"X400-Recipients",
	"X400-Trace",
	"Xref",

	// Common/de-facto non-standard headers
	"X-Forwarded-For",
	"X-Forwarded-Host",
	"X-Forwarded-Proto",
	"DNT",
	"X-Real-IP",
	"X-Request-ID",
	"X-Correlation-ID",
	"Traceparent",
	"Tracestate",
	"X-B3-TraceId",
	"X-B3-SpanId",
	"Upgrade-Insecure-Requests",
	"Tk",
	"X-Imforwards",
	"X-Powered-By",
	"X-Requested-With",

	// https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers
	"WWW-Authenticate",
	"Authorization",
	"Proxy-Authenticate",
	"Proxy-Authorization",
	"Age",
	"Cache-Control",
	"Clear-Site-Data",
	"Expires",
	"Pragma",
	"Warning",
	"Accept-CH",
	"Accept-CH-Lifetime",
	"Critical-CH",
	"Sec-CH-Prefers-Reduced-Motion",
	"Sec-CH-UA",
	"Sec-CH-UA-Arch",
	"Sec-CH-UA-Bitness",
	"Sec-CH-UA-Full-Version",
	"Sec-CH-UA-Full-Version-List",
	"Sec-CH-UA-Mobile",
	"Sec-CH-UA-Model",
	"Sec-CH-UA-Platform",
	"Sec-CH-UA-Platform-Version",
	"Content-DPR",
	"Device-Memory",
	"DPR",
	"Viewport-Width",
	"Width",
	"Downlink",
	"ECT",
	"RTT",
	"Save-Data",
	"Last-Modified",
	"ETag",
	"If-Match",
	"If-None-Match",
	"If-Modified-Since",
	"If-Unmodified-Since",
	"Vary",
	"Connection",
	"Keep-Alive",
	"Accept",
	"Accept-Encoding",
	"Accept-Language",
	"Expect",
	"Max-Forwards",
	"Cookie",
	"Set-Cookie",
	"Access-Control-Allow-Origin",
	"Access-Control-Allow-Credentials",
	"Access-Control-Allow-Headers",
	"Access-Control-Allow-Methods",
	"Access-Control-Expose-Headers",
	"Access-Control-Max-Age",
	"Access-Control-Request-Headers",
	"Access-Control-Request-Method",
	"Origin",
	"Timing-Allow-Origin",
	"Content-Disposition",
	"Content-Length",
	"Content-Type",
	"Content-Encoding",
	"Content-Language",
	"Content-Location",
	"Forwarded",
	"X-Forwarded-For",
	"X-Forwarded-Host",
	"X-Forwarded-Proto",
	"Via",
	"Location",
	"Refresh",
	"From",
	"Host",
	"Referer",
	"Referrer-Policy",
	"User-Agent",
	"Allow",
	"Server",
	"Accept-Ranges",
	"Range",
	"If-Range",
	"Content-Range",
	"Cross-Origin-Embedder-Policy",
	"Cross-Origin-Opener-Policy",
	"Cross-Origin-Resource-Policy",
	"Content-Security-Policy",
	"Content-Security-Policy-Report-Only",
	"Expect-CT",
	"Origin-Isolation",
	"Permissions-Policy",
	"Strict-Transport-Security",
	"Upgrade-Insecure-Requests",
	"X-Content-Type-Options",
	"X-Frame-Options",
	"X-Permitted-Cross-Domain-Policies",
	"X-Powered-By",
	"X-XSS-Protection",
	"Sec-Fetch-Site",
	"Sec-Fetch-Mode",
	"Sec-Fetch-User",
	"Sec-Fetch-Dest",
	"Service-Worker-Navigation-Preload",
	"Last-Event-ID",
	"NEL",
	"Ping-From",
	"Ping-To",
	"Report-To",
	"Transfer-Encoding",
	"TE",
	"Trailer",
	"Sec-WebSocket-Key",
	"Sec-WebSocket-Extensions",
	"Sec-WebSocket-Accept",
	"Sec-WebSocket-Protocol",
	"Sec-WebSocket-Version",
	"Accept-Push-Policy",
	"Accept-Signature",
	"Alt-Svc",
	"Date",
	"Early-Data",
	"Large-Allocation",
	"Link",
	"Push-Policy",
	"Retry-After",
	"Signature",
	"Signed-Headers",
	"Server-Timing",
	"Service-Worker-Allowed",
	"SourceMap",
	"Upgrade",
	"X-DNS-Prefetch-Control",
	"X-Firefox-Spdy",
	"X-Pingback",
	"X-Requested-With",
	"X-Robots-Tag",

	// https://en.wikipedia.org/wiki/List_of_HTTP_header_fields
	"Upgrade-Insecure-Requests",
	"X-Requested-With",
	"DNT",
	"X-Forwarded-For",
	"X-Forwarded-Host",
	"X-Forwarded-Proto",
	"Front-End-Https",
	"X-Http-Method-Override",
	"X-ATT-DeviceId",
	"X-Wap-Profile",
	"Proxy-Connection",
	"X-UIDH",
	"X-Csrf-Token",
	"X-Request-ID",
	"X-Correlation-ID",
	"Correlation-ID",
	"Save-Data",
	"Sec-GPC",
	"Content-Security-Policy",
	"X-Content-Security-Policy",
	"X-WebKit-CSP",
	"Expect-CT",
	"NEL",
	"Permissions-Policy",
	"Refresh",
	"Report-To",
	"Status",
	"Timing-Allow-Origin",
	"X-Content-Duration",
	"X-Content-Type-Options",
	"X-Powered-By",
	"X-Redirect-By",
	"X-Request-ID",
	"X-Correlation-ID",
	"X-UA-Compatible",
	"X-XSS-Protection",
}
